## üîÑ **–û–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω—è—è vs –î–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω—è—è —Å–≤—è–∑—å - –ø–æ–¥—Ä–æ–±–Ω–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ**

### **–¢–µ–∫—É—â–∞—è —Å–∏—Ç—É–∞—Ü–∏—è (Unidirectional Relationship)**

**–í Post.entity.ts:**

```typescript
@OneToOne(() => MetaOption, { cascade: true, eager: true })
@JoinColumn()
metaOptions?: MetaOption;
```

**–í MetaOption.entity.ts:**

```typescript
@Entity()
export class MetaOption {
  @PrimaryGeneratedColumn()
  id: number;

  @Column({ type: "json", nullable: false })
  metaValue: string;

  // –ù–ï–¢ –°–°–´–õ–ö–ò –ù–ê POST!
  // –≠—Ç–æ –¥–µ–ª–∞–µ—Ç —Å–≤—è–∑—å –æ–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω–µ–π
}
```

### **–ß—Ç–æ —ç—Ç–æ –∑–Ω–∞—á–∏—Ç –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ:**

**Post ‚Üí MetaOption: –î–ê**

- –ü–æ—Å—Ç –∑–Ω–∞–µ—Ç –æ —Å–≤–æ–∏—Ö –º–µ—Ç–∞-–æ–ø—Ü–∏—è—Ö
- –ú–æ–∂–µ–º –ø–æ–ª—É—á–∏—Ç—å –º–µ—Ç–∞-–æ–ø—Ü–∏–∏ –∏–∑ –ø–æ—Å—Ç–∞: `post.metaOptions`

**MetaOption ‚Üí Post: –ù–ï–¢**

- –ú–µ—Ç–∞-–æ–ø—Ü–∏—è –ù–ï –∑–Ω–∞–µ—Ç, –∫ –∫–∞–∫–æ–º—É –ø–æ—Å—Ç—É –æ–Ω–∞ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç
- –ù–µ –º–æ–∂–µ–º –ø–æ–ª—É—á–∏—Ç—å –ø–æ—Å—Ç –∏–∑ –º–µ—Ç–∞-–æ–ø—Ü–∏–∏: `metaOption.post` - –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç

## üéØ **–ß—Ç–æ —Ç–∞–∫–æ–µ Bidirectional Relationship**

### **–¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ:**

Bidirectional relationship - —ç—Ç–æ –∫–æ–≥–¥–∞ **–æ–±–µ —Å—É—â–Ω–æ—Å—Ç–∏ –∑–Ω–∞—é—Ç –¥—Ä—É–≥ –æ –¥—Ä—É–≥–µ**.

**–ê–Ω–∞–ª–æ–≥–∏—è:**

- **Unidirectional**: –¢–æ–ª—å–∫–æ –≤—ã –∑–Ω–∞–µ—Ç–µ —Å–≤–æ–µ–≥–æ –¥—Ä—É–≥–∞, –Ω–æ –≤–∞—à –¥—Ä—É–≥ –Ω–µ –∑–Ω–∞–µ—Ç –≤–∞—Å
- **Bidirectional**: –í—ã –∑–Ω–∞–µ—Ç–µ –¥—Ä—É–≥–∞, –∏ –¥—Ä—É–≥ –∑–Ω–∞–µ—Ç –≤–∞—Å - –≤–∑–∞–∏–º–Ω–∞—è —Å–≤—è–∑—å

### **–ö–∞–∫ –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å Bidirectional —Å–≤—è–∑—å:**

**–í Post.entity.ts (–æ—Å—Ç–∞–µ—Ç—Å—è –ø–æ—á—Ç–∏ —Ç–∞–∫–æ–π –∂–µ):**

```typescript
@OneToOne(() => MetaOption, metaOption => metaOption.post, {
    cascade: true,
    eager: true
})
@JoinColumn()
metaOptions?: MetaOption;
```

**–í MetaOption.entity.ts (–î–û–ë–ê–í–õ–Ø–ï–ú —Å–≤—è–∑—å):**

```typescript
@Entity()
export class MetaOption {
  @PrimaryGeneratedColumn()
  id: number;

  @Column({ type: "json", nullable: false })
  metaValue: string;

  // –ù–û–í–û–ï: –î–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω—è—è —Å–≤—è–∑—å
  @OneToOne(() => Post, (post) => post.metaOptions)
  post: Post; // –¢–µ–ø–µ—Ä—å MetaOption –∑–Ω–∞–µ—Ç –æ —Å–≤–æ–µ–º –ø–æ—Å—Ç–µ
}
```

## üó∫Ô∏è **–ì–¥–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è Foreign Key - –≤–∞–∂–Ω–æ–µ –ø–æ—è—Å—à–µ–Ω–∏–µ**

### **–¢–µ–∫—É—â–∞—è —Å–∏—Ç—É–∞—Ü–∏—è:**

```sql
-- –¢–∞–±–ª–∏—Ü–∞ posts
id | title      | metaOptionsId  ‚Üê FOREIGN KEY –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ó–î–ï–°–¨
1  | "My Post"  | 2

-- –¢–∞–±–ª–∏—Ü–∞ meta_option
id | metaValue
2  | '{"sidebar": true}'
```

**–ü—Ä–∞–≤–∏–ª–æ –∞–≤—Ç–æ—Ä–∞:**

> "Foreign key –≤—Å–µ–≥–¥–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü–µ —Ç–æ–π —Å—É—â–Ω–æ—Å—Ç–∏, –≥–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `@JoinColumn` –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä"

**–í –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ:**

- `@JoinColumn` –≤ `Post.entity.ts` ‚Üí foreign key –≤ —Ç–∞–±–ª–∏—Ü–µ `posts`
- –ï—Å–ª–∏ –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ `@JoinColumn` –≤ `MetaOption.entity.ts` ‚Üí foreign key –±—É–¥–µ—Ç –≤ —Ç–∞–±–ª–∏—Ü–µ `meta_option`

## üí° **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ Bidirectional Relationship**

### **1. –ù–∞–≤–∏–≥–∞—Ü–∏—è –≤ –æ–±–µ —Å—Ç–æ—Ä–æ–Ω—ã:**

**–°–µ–π—á–∞—Å (Unidirectional):**

```typescript
// –¢–æ–ª—å–∫–æ —Ç–∞–∫:
const post = await postRepository.findOne({
  where: { id: 1 },
  relations: ["metaOptions"],
});
console.log(post.metaOptions); // ‚úì –†–∞–±–æ—Ç–∞–µ—Ç

// –ê —Ç–∞–∫ –ù–ï —Ä–∞–±–æ—Ç–∞–µ—Ç:
const metaOption = await metaOptionRepository.findOne({ where: { id: 2 } });
console.log(metaOption.post); // ‚ùå –ù–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç!
```

**–° Bidirectional:**

```typescript
// –û–±–µ —Å—Ç–æ—Ä–æ–Ω—ã —Ä–∞–±–æ—Ç–∞—é—Ç:
const post = await postRepository.findOne({
  where: { id: 1 },
  relations: ["metaOptions"],
});
console.log(post.metaOptions); // ‚úì –†–∞–±–æ—Ç–∞–µ—Ç

const metaOption = await metaOptionRepository.findOne({
  where: { id: 2 },
  relations: ["post"],
});
console.log(metaOption.post); // ‚úì –¢–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç!
```

### **2. –ö–∞—Å–∫–∞–¥–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ (Cascade Delete)**

**–ü—Ä–æ–±–ª–µ–º–∞ –∫–æ—Ç–æ—Ä—É—é —Ä–µ—à–∞–µ–º:**

```typescript
// –°–µ–π—á–∞—Å –º—ã –¥–µ–ª–∞–µ–º –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –í–†–£–ß–ù–£–Æ:
public async delete(id: number) {
    let post = await this.postsRepository.findOneBy({ id });
    await this.postsRepository.delete(id);
    await this.metaOptionsRepository.delete(post.metaOptions.id); // ‚Üê –†—É—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞
}
```

**–° Bidirectional + Cascade:**

```typescript
// TypeORM –º–æ–∂–µ—Ç –¥–µ–ª–∞—Ç—å —ç—Ç–æ –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò
@OneToOne(() => MetaOption, metaOption => metaOption.post, {
    cascade: true,
    onDelete: 'CASCADE' // ‚Üê –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∫–∞—Å–∫–∞–¥–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ
})
@JoinColumn()
metaOptions?: MetaOption;
```

### **3. –ò–∑–±–µ–≥–∞–µ–º "–æ—Å–∏—Ä–æ—Ç–µ–≤—à–∏—Ö" –∑–∞–ø–∏—Å–µ–π**

**–ü—Ä–æ–±–ª–µ–º–∞:**

- –£–¥–∞–ª—è–µ–º –ø–æ—Å—Ç ‚Üí –º–µ—Ç–∞-–æ–ø—Ü–∏—è –æ—Å—Ç–∞–µ—Ç—Å—è –≤ –±–∞–∑–µ –±–µ—Å–ø–æ–ª–µ–∑–Ω–æ–π
- –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞—Å–æ—Ä—è–µ—Ç—Å—è –Ω–µ–Ω—É–∂–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏

**–†–µ—à–µ–Ω–∏–µ:**

- Bidirectional + cascade delete –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –º–µ—Ç–∞-–æ–ø—Ü–∏—è —É–¥–∞–ª–∏—Ç—Å—è –≤–º–µ—Å—Ç–µ —Å –ø–æ—Å—Ç–æ–º

## üèóÔ∏è **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**

### **–£–±–∏—Ä–∞–µ–º –º–µ–∂–º–æ–¥—É–ª—å–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**

```typescript
// –°–ï–ô–ß–ê–° (–ø—Ä–æ–±–ª–µ–º–∞):
export class PostsService {
  @InjectRepository(MetaOption) // ‚Üê –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç —á—É–∂–æ–π —Å—É—â–Ω–æ—Å—Ç–∏
  private readonly metaOptionsRepository: Repository<MetaOption>;

  // PostsService –∑–Ω–∞–µ—Ç –æ MetaOption - –Ω–∞—Ä—É—à–µ–Ω–∏–µ –≥—Ä–∞–Ω–∏—Ü –º–æ–¥—É–ª—è
}

// –° BIDIRECTIONAL (—Ä–µ—à–µ–Ω–∏–µ):
export class PostsService {
  // –¢–æ–ª—å–∫–æ —Å–≤–æ–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π!
  @InjectRepository(Post)
  private readonly postsRepository: Repository<Post>;

  // –£–¥–∞–ª–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ –∫–∞—Å–∫–∞–¥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
}
```

## üîç **–ö–æ–≥–¥–∞ –ø–æ–ª–µ–∑–Ω—ã Bidirectional Relationships**

### **Use Case 1: –ü–æ–∏—Å–∫ –ø–æ –º–µ—Ç–∞-–æ–ø—Ü–∏—è–º**

```typescript
// –•–æ—Ç–∏–º –Ω–∞–π—Ç–∏ –≤—Å–µ –ø–æ—Å—Ç—ã —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º–∏ –º–µ—Ç–∞-–æ–ø—Ü–∏—è–º–∏
// –° bidirectional —ç—Ç–æ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –≤–æ–∑–º–æ–∂–Ω—ã–º
const metaOptions = await metaOptionRepository.find({
  where: {
    metaValue: Like("%sidebarEnabled%"),
  },
  relations: ["post"], // ‚Üê –ü–æ–ª—É—á–∞–µ–º —Å–≤—è–∑–∞–Ω–Ω—ã–µ –ø–æ—Å—Ç—ã
});
```

### **Use Case 2: –í–∞–ª–∏–¥–∞—Ü–∏—è —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏**

```typescript
// –ú–æ–∂–µ–º –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –º–µ—Ç–∞-–æ–ø—Ü–∏—è –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º—É –ø–æ—Å—Ç—É
const metaOption = await metaOptionRepository.findOne({
  where: { id: metaId },
  relations: ["post"],
});

if (metaOption.post.id !== postId) {
  throw new Error("Meta option does not belong to this post!");
}
```

## üìä **–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ–¥—Ö–æ–¥–æ–≤**

| –ê—Å–ø–µ–∫—Ç                          | Unidirectional      | Bidirectional       |
| ------------------------------- | ------------------- | ------------------- |
| **–ì–∏–±–∫–æ—Å—Ç—å –Ω–∞–≤–∏–≥–∞—Ü–∏–∏**          | –¢–æ–ª—å–∫–æ –æ–¥–Ω–∞ —Å—Ç–æ—Ä–æ–Ω–∞ | –û–±–µ —Å—Ç–æ—Ä–æ–Ω—ã         |
| **–°–ª–æ–∂–Ω–æ—Å—Ç—å –∫–æ–¥–∞**              | –ü—Ä–æ—â–µ               | –°–ª–æ–∂–Ω–µ–µ (–¥–≤–µ —Å–≤—è–∑–∏) |
| **–ö–∞—Å–∫–∞–¥–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏**          | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–µ        | –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–µ         |
| **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É –º–æ–¥—É–ª—è–º–∏**  | –ï—Å—Ç—å —Ä–∏—Å–∫–∏          | –õ—É—á—à–∞—è –∏–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏—è |
| **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–æ–≤** | –û–¥–∏–Ω–∞–∫–æ–≤–∞—è          | –û–¥–∏–Ω–∞–∫–æ–≤–∞—è          |

## üéØ **–ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã –∏–∑ —ç—Ç–æ–≥–æ —É—Ä–æ–∫–∞**

1. **Bidirectional relationship** - —ç—Ç–æ –≤–∑–∞–∏–º–Ω–∞—è —Å–≤—è–∑—å, –≥–¥–µ –æ–±–µ —Å—É—â–Ω–æ—Å—Ç–∏ –∑–Ω–∞—é—Ç –¥—Ä—É–≥ –æ –¥—Ä—É–≥–µ
2. **Foreign key** –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –º–µ—Å—Ç–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `@JoinColumn`
3. **–ì–ª–∞–≤–Ω–æ–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ** - –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∫–∞—Å–∫–∞–¥–Ω–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è –∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –≤ –æ–±–µ —Å—Ç–æ—Ä–æ–Ω—ã
4. **–†–µ—à–∞–µ–º –ø—Ä–æ–±–ª–µ–º—É** "–æ—Å–∏—Ä–æ—Ç–µ–≤—à–∏—Ö" –º–µ—Ç–∞-–æ–ø—Ü–∏–π –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è –ø–æ—Å—Ç–æ–≤
5. **–£–ª—É—á—à–∞–µ–º –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É** - —É–º–µ–Ω—å—à–∞–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏

–í —Å–ª–µ–¥—É—é—â–µ–º –≤–∏–¥–µ–æ –∞–≤—Ç–æ—Ä –ø–æ–∫–∞–∂–µ—Ç –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é —ç—Ç–∏—Ö –∫–æ–Ω—Ü–µ–ø—Ü–∏–π –≤ –∫–æ–¥–µ! üöÄ
