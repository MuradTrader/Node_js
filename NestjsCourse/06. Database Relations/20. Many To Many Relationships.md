## üîÑ **–ß—Ç–æ —Ç–∞–∫–æ–µ Many-to-Many –æ—Ç–Ω–æ—à–µ–Ω–∏—è**

### **–ë–∞–∑–æ–≤–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ:**

Many-to-Many (–º–Ω–æ–≥–∏–µ-–∫–æ-–º–Ω–æ–≥–∏–º) - —ç—Ç–æ —Ç–∏–ø –æ—Ç–Ω–æ—à–µ–Ω–∏—è, –≥–¥–µ **–æ–¥–Ω–∞ —Å—É—â–Ω–æ—Å—Ç—å –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–≤—è–∑–∞–Ω–∞ —Å –º–Ω–æ–∂–µ—Å—Ç–≤–æ–º —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤ –¥—Ä—É–≥–æ–π —Å—É—â–Ω–æ—Å—Ç–∏, –∏ –Ω–∞–æ–±–æ—Ä–æ—Ç**.

### **–ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ø—Ä–∏–º–µ—Ä: Post ‚Üî Tag**

- **–û–¥–∏–Ω Post** –º–æ–∂–µ—Ç –∏–º–µ—Ç—å **–º–Ω–æ–≥–æ Tag** (JavaScript, TypeScript, NestJS)
- **–û–¥–∏–Ω Tag** –º–æ–∂–µ—Ç –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—Ç—å **–º–Ω–æ–≥–∏–º Post** (—Ç–µ–≥ "JavaScript" –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ 100+ –ø–æ—Å—Ç–∞—Ö)

## üóÉÔ∏è **–ü—Ä–æ–±–ª–µ–º–∞ –∫–æ—Ç–æ—Ä—É—é —Ä–µ—à–∞–µ–º**

### **–ü–æ—á–µ–º—É –Ω–µ–ª—å–∑—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–±—ã—á–Ω—ã–µ foreign keys:**

**–í One-to-Many/Many-to-One:**

```
posts —Ç–∞–±–ª–∏—Ü–∞:
id | title      | authorId
1  | "Post 1"   | 1

users —Ç–∞–±–ª–∏—Ü–∞:
id | name
1  | "John"
```

- –û–¥–∏–Ω foreign key –≤ posts —Ç–∞–±–ª–∏—Ü–µ

**–í Many-to-Many –ù–ï –†–ê–ë–û–¢–ê–ï–¢:**

```
posts —Ç–∞–±–ª–∏—Ü–∞:
id | title      | tagId?  ‚Üê –ü–†–û–ë–õ–ï–ú–ê: –º–æ–∂–µ—Ç –±—ã—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω tagId
1  | "Post 1"   | ?

tags —Ç–∞–±–ª–∏—Ü–∞:
id | name
1  | "JavaScript"
2  | "TypeScript"
```

- –û–¥–∏–Ω –ø–æ—Å—Ç –Ω–µ –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–µ–≥–æ–≤ –≤ —Ç–∞–∫–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ

## üèóÔ∏è **–†–µ—à–µ–Ω–∏–µ: Junction Table (–°–≤—è–∑—É—é—â–∞—è —Ç–∞–±–ª–∏—Ü–∞)**

### **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Many-to-Many:**

```
Post entity              post_tags junction table          Tag entity
+-------------+          +--------------------+          +-------------+
| id          |          | postId (FK)        |          | id          |
| title       |‚Üê--------‚Üí| tagId  (FK)        |‚Üê--------‚Üí| name        |
| content     |          +--------------------+          | slug        |
+-------------+          | (composite PK)     |          +-------------+
```

### **–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç junction table:**

**–ü—Ä–∏–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö:**

```sql
-- –¢–∞–±–ª–∏—Ü–∞ posts
id | title
1  | "NestJS Tutorial"
2  | "TypeScript Tips"

-- –¢–∞–±–ª–∏—Ü–∞ tags
id | name
1  | "JavaScript"
2  | "TypeScript"
3  | "NestJS"

-- Junction table post_tags
postId | tagId
1      | 1      -- Post 1 –∏–º–µ–µ—Ç —Ç–µ–≥ "JavaScript"
1      | 2      -- Post 1 –∏–º–µ–µ—Ç —Ç–µ–≥ "TypeScript"
1      | 3      -- Post 1 –∏–º–µ–µ—Ç —Ç–µ–≥ "NestJS"
2      | 2      -- Post 2 –∏–º–µ–µ—Ç —Ç–µ–≥ "TypeScript"
```

## ‚öôÔ∏è **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤ TypeORM**

### **–î–≤–∞ –ø–æ–¥—Ö–æ–¥–∞:**

1. **Unidirectional (–û–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω—è—è)** - —Ç–æ–ª—å–∫–æ –æ–¥–Ω–∞ —Å—É—â–Ω–æ—Å—Ç—å –∑–Ω–∞–µ—Ç –æ —Å–≤—è–∑–∏
2. **Bidirectional (–î–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω—è—è)** - –æ–±–µ —Å—É—â–Ω–æ—Å—Ç–∏ –∑–Ω–∞—é—Ç –æ —Å–≤—è–∑–∏

### **Unidirectional –ø—Ä–∏–º–µ—Ä (—Ç–æ–ª—å–∫–æ Post –∑–Ω–∞–µ—Ç –æ Tags):**

```typescript
@Entity()
export class Post {
  @PrimaryGeneratedColumn()
  id: number;

  @ManyToMany(() => Tag)
  @JoinTable() // ‚Üê –î–µ–∫–æ—Ä–∞—Ç–æ—Ä —Ç–æ–ª—å–∫–æ –Ω–∞ –æ–¥–Ω–æ–π —Å—Ç–æ—Ä–æ–Ω–µ
  tags: Tag[];
}

@Entity()
export class Tag {
  @PrimaryGeneratedColumn()
  id: number;

  // –ù–ï–¢ —Å—Å—ã–ª–∫–∏ –Ω–∞ Post - –æ–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω—è—è —Å–≤—è–∑—å
}
```

### **Bidirectional –ø—Ä–∏–º–µ—Ä (–æ–±–µ —Å—Ç–æ—Ä–æ–Ω—ã –∑–Ω–∞—é—Ç):**

```typescript
@Entity()
export class Post {
  @PrimaryGeneratedColumn()
  id: number;

  @ManyToMany(() => Tag, (tag) => tag.posts)
  @JoinTable()
  tags: Tag[];
}

@Entity()
export class Tag {
  @PrimaryGeneratedColumn()
  id: number;

  @ManyToMany(() => Post, (post) => post.tags)
  posts: Post[];
}
```

## üéØ **–ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ Many-to-Many**

### **1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è junction table:**

- TypeORM **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç** —Å–≤—è–∑—É—é—â—É—é —Ç–∞–±–ª–∏—Ü—É
- –ò–º—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `post_tags_tag` (entity1_entity2_field)
- –ú–æ–∂–Ω–æ –∫–∞—Å—Ç–æ–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ `@JoinTable` –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

### **2. –°–æ—Å—Ç–∞–≤–Ω–æ–π –ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á:**

```sql
-- Junction table –∏–º–µ–µ—Ç —Å–æ—Å—Ç–∞–≤–Ω–æ–π PK
post_tags —Ç–∞–±–ª–∏—Ü–∞:
postId (PK, FK) | tagId (PK, FK)
```

### **3. –ö–∞—Å–∫–∞–¥–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏:**

```typescript
@ManyToMany(() => Tag, {
    cascade: true // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å —Ç–µ–≥–∏ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –ø–æ—Å—Ç–∞
})
@JoinTable()
tags: Tag[];
```

## üîÑ **–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º–∏ —Ç–∏–ø–∞–º–∏ –æ—Ç–Ω–æ—à–µ–Ω–∏–π**

| –ê—Å–ø–µ–∫—Ç          | One-to-One        | One-to-Many      | Many-to-Many     |
| --------------- | ----------------- | ---------------- | ---------------- |
| **–ü—Ä–∏–º–µ—Ä**      | Post ‚Üî MetaOption | User ‚Üî Post      | Post ‚Üî Tag       |
| **Foreign key** | –í –æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ   | –í —Ç–∞–±–ª–∏—Ü–µ "Many" | –í junction table |
| **@JoinColumn** | –û–±—è–∑–∞—Ç–µ–ª–µ–Ω        | –ù–µ –Ω—É–∂–µ–Ω         | –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è  |
| **@JoinTable**  | –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è   | –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è  | –û–±—è–∑–∞—Ç–µ–ª–µ–Ω       |

## üöÄ **–ß—Ç–æ –±—É–¥–µ—Ç –≤ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏**

### **–ü–ª–∞–Ω –∞–≤—Ç–æ—Ä–∞:**

1. **–°–Ω–∞—á–∞–ª–∞ Unidirectional** - –ø—Ä–æ—Å—Ç–æ–π –≤–∞—Ä–∏–∞–Ω—Ç –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è
2. **–ó–∞—Ç–µ–º Bidirectional** - –ø–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç
3. **–†–∞–±–æ—Ç–∞ —Å –¥–∞–Ω–Ω—ã–º–∏** - —Å–æ–∑–¥–∞–Ω–∏–µ, —á—Ç–µ–Ω–∏–µ, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–≤—è–∑–µ–π

### **–û–∂–∏–¥–∞–µ–º—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**

```typescript
// –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Å—Ç–∞ —Å —Ç–µ–≥–∞–º–∏
const post = new Post();
post.title = "My Post";
post.tags = [tag1, tag2, tag3]; // –ü—Ä–∏–≤—è–∑—ã–≤–∞–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–µ–≥–æ–≤

// –ü–æ–∏—Å–∫ –ø–æ—Å—Ç–æ–≤ –ø–æ —Ç–µ–≥—É
const posts = await postRepository.find({
  where: {
    tags: { name: "JavaScript" },
  },
});

// –ü–æ–∏—Å–∫ —Ç–µ–≥–æ–≤ –ø–æ—Å—Ç–∞
const postWithTags = await postRepository.findOne({
  where: { id: 1 },
  relations: ["tags"],
});
```

## üí° **–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –ø–æ–ª—å–∑–∞ –≤ –±–ª–æ–≥-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏**

### **–î–ª—è Post:**

- –ö–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- –£–ª—É—á—à–µ–Ω–∏–µ SEO —á–µ—Ä–µ–∑ —Ç–µ–≥–∏
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Ç–µ–º–∞–º
- –°–≤—è–∑—ã–≤–∞–Ω–∏–µ related content

### **–î–ª—è Tag:**

- –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö —Ç–µ–º
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
- –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –∫–æ–Ω—Ç–µ–Ω—Ç—É
- –û–±–ª–∞–∫–æ —Ç–µ–≥–æ–≤

## üéì **–ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã –∏–∑ —Ç–µ–æ—Ä–∏–∏**

1. **Many-to-Many** —Ç—Ä–µ–±—É–µ—Ç **junction table** –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–≤—è–∑–µ–π
2. **Junction table** —Å–æ–¥–µ—Ä–∂–∏—Ç foreign keys –Ω–∞ –æ–±–µ —Ç–∞–±–ª–∏—Ü—ã
3. **TypeORM –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏** —É–ø—Ä–∞–≤–ª—è–µ—Ç junction table
4. **–ú–æ–∂–µ—Ç –±—ã—Ç—å unidirectional –∏–ª–∏ bidirectional**
5. **@JoinTable** –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –≤–ª–∞–¥–µ–ª—å—Ü–∞ —Å–≤—è–∑–∏
6. **–°–∞–º—ã–π —Å–ª–æ–∂–Ω—ã–π** –Ω–æ –∏ —Å–∞–º—ã–π –º–æ—â–Ω—ã–π —Ç–∏–ø –æ—Ç–Ω–æ—à–µ–Ω–∏–π

–≠—Ç–∞ —Ç–µ–æ—Ä–∏—è —Å–æ–∑–¥–∞–µ—Ç –ø—Ä–æ—á–Ω—É—é –æ—Å–Ω–æ–≤—É –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è —Å–∞–º–æ–π —Å–ª–æ–∂–Ω–æ–π, –Ω–æ –∏ —Å–∞–º–æ–π –ø–æ–ª–µ–∑–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –æ—Ç–Ω–æ—à–µ–Ω–∏–π –≤ —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã—Ö –±–∞–∑–∞—Ö –¥–∞–Ω–Ω—ã—Ö! üöÄ
