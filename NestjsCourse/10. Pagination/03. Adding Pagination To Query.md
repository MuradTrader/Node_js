## üéØ **–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏**

### ‚ùå **–ü—Ä–æ–±–ª–µ–º–∞ –≤ –∏—Å—Ö–æ–¥–Ω–æ–º –∫–æ–¥–µ:**

```typescript
// –ë–´–õ–û - –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –í–°–ï –ø–æ—Å—Ç—ã
public async findAll(userId: string) {
    let posts = await this.postsRepository.find({
        relations: {
            metaOptions: true,
        },
    });
    return posts; // ‚Üê –í–°–ï –ø–æ—Å—Ç—ã –∏–∑ –ë–î
}
```

## üîß **–®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö**

### üìä **–°–æ—Å—Ç–æ—è–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:**

–ê–≤—Ç–æ—Ä —Å–æ–∑–¥–∞–µ—Ç 7 —Ç–µ—Å—Ç–æ–≤—ã—Ö –ø–æ—Å—Ç–æ–≤ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏:

| ID  | Title  | Author |
| --- | ------ | ------ |
| 10  | Post 1 | User 1 |
| 11  | Post 2 | User 1 |
| 12  | Post 3 | User 2 |
| ... | ...    | ...    |

## üîß **–®–∞–≥ 2: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–µ—Ç–æ–¥–∞ findAll –≤ —Å–µ—Ä–≤–∏—Å–µ**

### üìù **–ù–æ–≤–∞—è —Å–∏–≥–Ω–∞—Ç—É—Ä–∞ –º–µ—Ç–æ–¥–∞:**

```typescript
// –°–¢–ê–õ–û - –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
public async findAll(userId: string, postsQuery: GetPostsDto) {
    // –î–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏–∑–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
    const { limit, page } = postsQuery;

    // –ü–ê–ì–ò–ù–ê–¶–ò–Ø –° –ü–û–ú–û–©–¨–Æ skip –ò take
    let posts = await this.postsRepository.find({
        skip: (page - 1) * limit,  // ‚úÖ –°–ö–û–õ–¨–ö–û –ü–†–û–ü–£–°–¢–ò–¢–¨
        take: limit,               // ‚úÖ –°–ö–û–õ–¨–ö–û –í–ó–Ø–¢–¨
    });

    return posts;
}
```

## üîç **–ì–ª—É–±–æ–∫–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ skip –∏ take**

### üßÆ **–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏:**

```typescript
skip = (page - 1) * limit;
take = limit;
```

**–ü—Ä–∏–º–µ—Ä—ã —Ä–∞—Å—á–µ—Ç–æ–≤:**

| –°—Ç—Ä–∞–Ω–∏—Ü–∞ | Limit | Skip         | Take | –†–µ–∑—É–ª—å—Ç–∞—Ç |
| -------- | ----- | ------------ | ---- | --------- |
| 1        | 2     | (1-1)\*2 = 0 | 2    | –ü–æ—Å—Ç—ã 1-2 |
| 2        | 2     | (2-1)\*2 = 2 | 2    | –ü–æ—Å—Ç—ã 3-4 |
| 3        | 1     | (3-1)\*1 = 2 | 1    | –ü–æ—Å—Ç 3    |

### üìä **–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è limit=2:**

```
–°—Ç—Ä–∞–Ω–∏—Ü–∞ 1 (skip=0, take=2): [–ü–æ—Å—Ç10, –ü–æ—Å—Ç11]
–°—Ç—Ä–∞–Ω–∏—Ü–∞ 2 (skip=2, take=2): [–ü–æ—Å—Ç12, –ü–æ—Å—Ç13]
–°—Ç—Ä–∞–Ω–∏—Ü–∞ 3 (skip=4, take=2): [–ü–æ—Å—Ç14, –ü–æ—Å—Ç15]
–°—Ç—Ä–∞–Ω–∏—Ü–∞ 4 (skip=6, take=2): [–ü–æ—Å—Ç16]
```

## üîß **–®–∞–≥ 3: TypeORM QueryBuilder vs Repository**

### ‚ö° **–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º:**

```sql
-- –î–ª—è page=1, limit=2
SELECT * FROM posts
ORDER BY id
LIMIT 2 OFFSET 0;

-- –î–ª—è page=3, limit=1
SELECT * FROM posts
ORDER BY id
LIMIT 1 OFFSET 2;
```

## üîß **–®–∞–≥ 4: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞**

### üéØ **–ü–µ—Ä–µ–¥–∞—á–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤ —Å–µ—Ä–≤–∏—Å:**

```typescript
@Get("/:userId?")
public getPosts(
    @Param("userId") userId: string,
    @Query() postsQuery: GetPostsDto  // ‚úÖ –ü–ê–†–ê–ú–ï–¢–†–´ –ü–ê–ì–ò–ù–ê–¶–ò–ò
) {
    return this.postsService.findAll(userId, postsQuery);
}
```

## üß™ **–®–∞–≥ 5: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏**

### üî¨ **–¢–µ—Å—Ç 1: Limit=2, Page=1**

```http
GET http://localhost:3000/posts?limit=2&page=1
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**

```json
[
  { "id": 10, "title": "Post 10" },
  { "id": 11, "title": "Post 11" }
]
```

### üî¨ **–¢–µ—Å—Ç 2: Limit=1, Page=1**

```http
GET http://localhost:3000/posts?limit=1&page=1
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**

```json
[{ "id": 10, "title": "Post 10" }]
```

### üî¨ **–¢–µ—Å—Ç 3: Limit=1, Page=3**

```http
GET http://localhost:3000/posts?limit=1&page=3
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**

```json
[{ "id": 12, "title": "Post 12" }]
```

## üéØ **–ö–ª—é—á–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ª–æ–≥–∏–∫–µ**

### üîÑ **–£–ø—Ä–æ—â–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞:**

```typescript
// –ë–´–õ–û - —Å–ª–æ–∂–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –æ—Ç–Ω–æ—à–µ–Ω–∏–π
let posts = await this.postsRepository.find({
  relations: {
    metaOptions: true,
    // author: true,    // ‚ùå –£–î–ê–õ–ï–ù–û
    // tags: true,      // ‚ùå –£–î–ê–õ–ï–ù–û
  },
});

// –°–¢–ê–õ–û - —Ç–æ–ª—å–∫–æ –ø–∞–≥–∏–Ω–∞—Ü–∏—è
let posts = await this.postsRepository.find({
  skip: (page - 1) * limit,
  take: limit,
});
```

**–ü–æ—á–µ–º—É –æ—Ç–Ω–æ—à–µ–Ω–∏—è –≤—Å–µ —Ä–∞–≤–Ω–æ —Ä–∞–±–æ—Ç–∞—é—Ç:**

- –í —Å—É—â–Ω–æ—Å—Ç–∏ `Post` –ø–æ–ª—è `author` –∏ `tags` –ø–æ–º–µ—á–µ–Ω—ã –∫–∞–∫ `eager: true`
- TypeORM –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç `eager` –æ—Ç–Ω–æ—à–µ–Ω–∏—è –±–µ–∑ —É–∫–∞–∑–∞–Ω–∏—è `relations`
- `metaOptions` —Ç–∞–∫–∂–µ –∏–º–µ–µ—Ç `eager: true` –≤ —Å—É—â–Ω–æ—Å—Ç–∏ `Post`

## ‚ö†Ô∏è **–¢–µ–∫—É—â–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏**

### ‚ùå **–ü—Ä–æ–±–ª–µ–º—ã —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–¥—Ö–æ–¥–∞:**

1. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –º–µ—Ç–∞-–¥–∞–Ω–Ω—ã—Ö:**

```typescript
// –°–ï–ô–ß–ê–°: —Ç–æ–ª—å–∫–æ –º–∞—Å—Å–∏–≤ –ø–æ—Å—Ç–æ–≤
[
    { "id": 10, "title": "Post 10" },
    { "id": 11, "title": "Post 11" }
]

// –î–û–õ–ñ–ù–û –ë–´–¢–¨: —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç
{
    "data": [...],
    "meta": { ... },
    "links": { ... }
}
```

2. **–ù–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –æ–±—â–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ:**

- –ù–µ –∑–Ω–∞–µ–º —Å–∫–æ–ª—å–∫–æ –≤—Å–µ–≥–æ –ø–æ—Å—Ç–æ–≤
- –ù–µ –∑–Ω–∞–µ–º —Å–∫–æ–ª—å–∫–æ –≤—Å–µ–≥–æ —Å—Ç—Ä–∞–Ω–∏—Ü
- –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å "–°—Ç—Ä–∞–Ω–∏—Ü–∞ 1 –∏–∑ 10"

3. **–ù–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è userId:**

```typescript
// –ü–∞—Ä–∞–º–µ—Ç—Ä userId –ø—Ä–∏–Ω–∏–º–∞–µ—Ç—Å—è, –Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è!
public async findAll(userId: string, postsQuery: GetPostsDto)
```

## üéØ **–ß—Ç–æ –∞–≤—Ç–æ—Ä –ø–ª–∞–Ω–∏—Ä—É–µ—Ç —É–ª—É—á—à–∏—Ç—å**

### üîÆ **–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:**

1. **–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç** - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ meta –∏ links
2. **–ü–æ–¥—Å—á–µ—Ç –æ–±—â–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞** - –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ totalPages
3. **–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç—å** - —Ä–∞–±–æ—Ç–∞ —Å –ª—é–±—ã–º–∏ —Å—É—â–Ω–æ—Å—Ç—è–º–∏
4. **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ userId** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞

## üìä **–¢–µ–∫—É—â–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–∞–≥–∏–Ω–∞—Ü–∏–∏**

### ‚úÖ **–ß—Ç–æ —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:**

- ‚úÖ –ë–∞–∑–æ–≤–∞—è –ø–∞–≥–∏–Ω–∞—Ü–∏—è (skip/take)
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ query –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ç–∏–ø–æ–≤
- ‚úÖ Eager loading –æ—Ç–Ω–æ—à–µ–Ω–∏–π

### ‚ùå **–ß—Ç–æ –Ω—É–∂–Ω–æ –¥–æ—Ä–∞–±–æ—Ç–∞—Ç—å:**

- ‚ùå –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç–≤–µ—Ç–∞ (—Ç–æ–ª—å–∫–æ –º–∞—Å—Å–∏–≤)
- ‚ùå –ú–µ—Ç–∞-–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
- ‚ùå –ù–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å—Å—ã–ª–∫–∏
- ‚ùå –ü–æ–¥—Å—á–µ—Ç –æ–±—â–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤

## üéØ **–ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã –∞–≤—Ç–æ—Ä–∞:**

**"–ë–∞–∑–æ–≤–∞—è –ø–∞–≥–∏–Ω–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç–≤–µ—Ç–∞ –Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è production"**

–ê–≤—Ç–æ—Ä –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç, —á—Ç–æ –º–µ—Ö–∞–Ω–∏–∑–º –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ TypeORM —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, –Ω–æ –¥–ª—è –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–≥–æ API –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–µ—Ä–Ω—É—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç —Å –º–µ—Ç–∞-–¥–∞–Ω–Ω—ã–º–∏, –∫–æ—Ç–æ—Ä—ã–π –±—ã–ª –æ–ø–∏—Å–∞–Ω –≤ —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–æ–º –æ–±–∑–æ—Ä–µ.
