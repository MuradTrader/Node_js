## üéØ **–¶–µ–ª—å: –°–æ–∑–¥–∞–Ω–∏–µ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –ø–∞–≥–∏–Ω–∞—Ü–∏–∏**

### ‚ùå **–ü—Ä–æ–±–ª–µ–º–∞ —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:**

```typescript
// –¢–µ–∫—É—â–∞—è –ø–∞–≥–∏–Ω–∞—Ü–∏—è –≤ PostsService - –Ω–µ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º–∞—è
public async findAll(userId: string, postsQuery: GetPostsDto) {
    let posts = await this.postsRepository.find({
        skip: (page - 1) * limit,
        take: limit,
    });
    return posts; // ‚ùå –¢–æ–ª—å–∫–æ –º–∞—Å—Å–∏–≤, –Ω–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
}
```

## üèóÔ∏è **–°–æ–∑–¥–∞–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –ø–∞–≥–∏–Ω–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ –º–æ–¥—É–ª—è**

### üìÅ **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–∞—Ç–∞–ª–æ–≥–æ–≤:**

```
src/common/pagination/
‚îú‚îÄ‚îÄ dtos/
‚îÇ   ‚îî‚îÄ‚îÄ pagination-query.dto.ts      # ‚úÖ –£–∂–µ —Å–æ–∑–¥–∞–Ω
‚îú‚îÄ‚îÄ interfaces/
‚îÇ   ‚îî‚îÄ‚îÄ paginated.interface.ts       # ‚úÖ –ù–æ–≤—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
‚îú‚îÄ‚îÄ providers/
‚îÇ   ‚îî‚îÄ‚îÄ pagination.provider.ts       # ‚úÖ –ù–æ–≤—ã–π –ø—Ä–æ–≤–∞–π–¥–µ—Ä
‚îî‚îÄ‚îÄ pagination.module.ts             # ‚úÖ –ù–æ–≤—ã–π –º–æ–¥—É–ª—å
```

## üîß **–®–∞–≥ 1: –°–æ–∑–¥–∞–Ω–∏–µ PaginationModule**

### üèóÔ∏è **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –º–æ–¥—É–ª—è:**

```bash
npx nest g module common/pagination --flat --no-spec
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç - `pagination.module.ts`:**

```typescript
@Module({})
export class PaginationModule {}
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã CLI:**

- `--flat` - —Å–æ–∑–¥–∞–µ—Ç —Ñ–∞–π–ª –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏, –±–µ–∑ –≤–ª–æ–∂–µ–Ω–Ω–æ–π –ø–∞–ø–∫–∏
- `--no-spec` - –Ω–µ —Å–æ–∑–¥–∞–µ—Ç —Ñ–∞–π–ª –¥–ª—è —Ç–µ—Å—Ç–æ–≤

## üîß **–®–∞–≥ 2: –°–æ–∑–¥–∞–Ω–∏–µ PaginationProvider**

### üèóÔ∏è **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞:**

```bash
npx nest g provider common/pagination/providers/pagination --flat --no-spec
```

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è:**
NestJS –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –ø—Ä–æ–≤–∞–π–¥–µ—Ä –≤ –º–æ–¥—É–ª—å:

```typescript
@Module({
  providers: [PaginationProvider], // ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª–µ–Ω
  exports: [PaginationProvider], // ‚úÖ –î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –¥—Ä—É–≥–∏—Ö –º–æ–¥—É–ª—è—Ö
})
export class PaginationModule {}
```

## üéØ **–®–∞–≥ 3: –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ Paginated**

### üìù **–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞:**

```typescript
// src/common/pagination/interfaces/paginated.interface.ts
export interface Paginated<T> {
  data: T[]; // ‚úÖ –ú–∞—Å—Å–∏–≤ —Å—É—â–Ω–æ—Å—Ç–µ–π
  meta: {
    // ‚úÖ –ú–µ—Ç–∞-–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
    itemsPerPage: number;
    totalItems: number;
    currentPage: number;
    totalPages: number;
  };
  links: {
    // ‚úÖ –ù–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å—Å—ã–ª–∫–∏
    first: string;
    last: string;
    current: string;
    next: string;
    previous: string;
  };
}
```

### üîç **–î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ Generic `<T>`:**

**–ë–µ–∑ Generic:**

```typescript
// ‚ùå –ñ–µ—Å—Ç–∫–∞—è –ø—Ä–∏–≤—è–∑–∫–∞ –∫ –ø–æ—Å—Ç–∞–º
interface Paginated {
  data: Post[]; // –¢–æ–ª—å–∫–æ –ø–æ—Å—Ç—ã!
}
```

**–° Generic:**

```typescript
// ‚úÖ –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç—å –¥–ª—è –ª—é–±—ã—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π
interface Paginated<T> {
  data: T[]; // –ú–æ–∂–µ—Ç –±—ã—Ç—å Post[], User[], Tag[] –∏ —Ç.–¥.
}
```

**–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**

```typescript
const postsResponse: Paginated<Post> = {
    data: [post1, post2], // Post[]
    meta: {...},
    links: {...}
};

const usersResponse: Paginated<User> = {
    data: [user1, user2], // User[]
    meta: {...},
    links: {...}
};
```

## üîß **–®–∞–≥ 4: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è PaginationProvider**

### üèóÔ∏è **Generic –º–µ—Ç–æ–¥ paginateQuery:**

```typescript
// src/common/pagination/providers/pagination.provider.ts
export class PaginationProvider {
  public async paginateQuery<T extends ObjectLiteral>(
    paginationQuery: PaginationQueryDto,
    repository: Repository<T>
  ): Promise<T[]> {
    // –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏...
  }
}
```

### üîç **–ì–ª—É–±–æ–∫–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ Generic –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:**

#### **`<T extends ObjectLiteral>`**

```typescript
T extends ObjectLiteral
```

**–ß—Ç–æ —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç:**

- `T` - –ª—é–±–æ–π —Ç–∏–ø, –∫–æ—Ç–æ—Ä—ã–π —Ä–∞—Å—à–∏—Ä—è–µ—Ç `ObjectLiteral`
- `ObjectLiteral` - –ø—Ä–æ—Å—Ç–æ–π –æ–±—ä–µ–∫—Ç —Å –∫–ª—é—á–∞–º–∏-—Å—Ç—Ä–æ–∫–∞–º–∏
- –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ `T` - —ç—Ç–æ —Å—É—â–Ω–æ—Å—Ç—å TypeORM

#### **`Repository<T>`**

```typescript
repository: Repository<T>;
```

**–ß—Ç–æ —ç—Ç–æ –¥–∞–µ—Ç:**

- TypeORM –∑–Ω–∞–µ—Ç —Ç–∏–ø —Å—É—â–Ω–æ—Å—Ç–∏ `T`
- –ê–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
- Type safety –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å —Å—É—â–Ω–æ—Å—Ç—è–º–∏

### üîÑ **–ü–µ—Ä–µ–Ω–æ—Å –ª–æ–≥–∏–∫–∏ –∏–∑ PostsService:**

```typescript
// –ë–´–õ–û –≤ PostsService:
let posts = await this.postsRepository.find({
    skip: (page - 1) * limit,
    take: limit,
});

// –°–¢–ê–õ–û –≤ PaginationProvider:
public async paginateQuery<T extends ObjectLiteral>(
    paginationQuery: PaginationQueryDto,
    repository: Repository<T>
): Promise<T[]> {
    const { limit, page } = paginationQuery;

    const results = await repository.find({
        skip: (page - 1) * limit,
        take: limit,
    });

    return results;
}
```

## üéØ **–ö–ª—é—á–µ–≤—ã–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**

### ‚úÖ **–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç—å:**

```typescript
// –†–∞–±–æ—Ç–∞–µ—Ç —Å –õ–Æ–ë–û–ô —Å—É—â–Ω–æ—Å—Ç—å—é TypeORM
await paginationProvider.paginateQuery(paginationQuery, postRepository);
await paginationProvider.paginateQuery(paginationQuery, userRepository);
await paginationProvider.paginateQuery(paginationQuery, tagRepository);
```

### ‚úÖ **Type Safety:**

- TypeScript –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ç–∏–ø—ã –Ω–∞ —ç—Ç–∞–ø–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏
- –ê–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –≤ IDE
- –ó–∞—â–∏—Ç–∞ –æ—Ç runtime –æ—à–∏–±–æ–∫

### ‚úÖ **–ò–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏—è –ª–æ–≥–∏–∫–∏:**

- –í—Å—è –ª–æ–≥–∏–∫–∞ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ
- –õ–µ–≥–∫–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å
- –°–ª–µ–¥—É–µ—Ç –ø—Ä–∏–Ω—Ü–∏–ø—É DRY (Don't Repeat Yourself)

## üîÆ **–ß—Ç–æ –±—É–¥–µ—Ç –≤ —Å–ª–µ–¥—É—é—â–µ–º –≤–∏–¥–µ–æ:**

### üéØ **–ü–ª–∞–Ω—ã –∞–≤—Ç–æ—Ä–∞:**

1. **–î–æ—Ä–∞–±–æ—Ç–∞—Ç—å –º–µ—Ç–æ–¥** `paginateQuery` –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞ `Paginated<T>`
2. **–î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥—Å—á–µ—Ç –æ–±—â–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞** —ç–ª–µ–º–µ–Ω—Ç–æ–≤
3. **–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å—Å—ã–ª–∫–∏**
4. **–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å PostsService**

### üìù **–ë—É–¥—É—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç–≤–µ—Ç–∞:**

```typescript
// –ü–æ—Å–ª–µ –¥–æ—Ä–∞–±–æ—Ç–∫–∏ –º–µ—Ç–æ–¥ –±—É–¥–µ—Ç –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å:
{
    data: T[],           // –ü–∞–≥–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
    meta: {              // –ú–µ—Ç–∞-–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
        itemsPerPage: 10,
        totalItems: 156,
        currentPage: 1,
        totalPages: 16
    },
    links: {             // –ù–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å—Å—ã–ª–∫–∏
        first: "/posts?limit=10&page=1",
        last: "/posts?limit=10&page=16",
        current: "/posts?limit=10&page=1",
        next: "/posts?limit=10&page=2",
        previous: null
    }
}
```

## üéØ **–ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã, –∫–æ—Ç–æ—Ä—ã–µ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –∞–≤—Ç–æ—Ä:**

### 1. **Separation of Concerns:**

- –ü–∞–≥–∏–Ω–∞—Ü–∏—è –≤—ã–Ω–µ—Å–µ–Ω–∞ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π –º–æ–¥—É–ª—å
- –°–µ—Ä–≤–∏—Å—ã –∑–∞–Ω–∏–º–∞—é—Ç—Å—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–æ–π, –∞ –Ω–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–º–∏ –¥–µ—Ç–∞–ª—è–º–∏

### 2. **Reusability:**

- –û–¥–∏–Ω –∫–æ–¥ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ –¥–ª—è –≤—Å–µ—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π
- –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–∞–≥–∏–Ω–∞—Ü–∏—é –∫ –Ω–æ–≤—ã–º endpoints

### 3. **Type Safety:**

- Generics –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ª—é–±—ã–º–∏ —Å—É—â–Ω–æ—Å—Ç—è–º–∏
- TypeORM Repository –¥–ª—è —Ç–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### 4. **Maintainability:**

- –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ª–æ–≥–∏–∫–µ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ
- –õ–µ–≥–∫–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ

–≠—Ç–æ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ —Å–æ–∑–¥–∞–Ω–∏—é –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –º–æ–¥—É–ª–µ–π –≤ NestJS! üöÄ
