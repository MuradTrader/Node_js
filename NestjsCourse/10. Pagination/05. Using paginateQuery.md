## üéØ **–¶–µ–ª—å: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è PaginationProvider –≤ PostsService**

### ‚ùå **–¢–µ–∫—É—â–∞—è –ø—Ä–æ–±–ª–µ–º–∞:**

```typescript
// PostsService - –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
public async findAll(userId: string, postsQuery: GetPostsDto) {
    let posts = await this.postsRepository.find({
        skip: (postsQuery.page - 1) * postsQuery.limit,
        take: postsQuery.limit,
    });
    return posts;
}
```

## üîß **–®–∞–≥ 1: –≠–∫—Å–ø–æ—Ä—Ç PaginationProvider –∏–∑ –º–æ–¥—É–ª—è**

### üì¶ **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ PaginationModule:**

```typescript
// src/common/pagination/pagination.module.ts
@Module({
  providers: [PaginationProvider],
  exports: [PaginationProvider], // ‚úÖ –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û!
})
export class PaginationModule {}
```

**–ü–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ:**

- –ë–µ–∑ `exports` –ø—Ä–æ–≤–∞–π–¥–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –≤–Ω–µ –º–æ–¥—É–ª—è
- `exports` –¥–µ–ª–∞–µ—Ç –ø—Ä–æ–≤–∞–π–¥–µ—Ä "–ø—É–±–ª–∏—á–Ω—ã–º" –¥–ª—è –¥—Ä—É–≥–∏—Ö –º–æ–¥—É–ª–µ–π
- –°–ª–µ–¥—É–µ—Ç –ø—Ä–∏–Ω—Ü–∏–ø—É –∏–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏–∏ NestJS –º–æ–¥—É–ª–µ–π

## üîß **–®–∞–≥ 2: –ò–º–ø–æ—Ä—Ç PaginationModule –≤ PostsModule**

### üîó **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**

```typescript
// src/posts/posts.module.ts
@Module({
  controllers: [PostsController],
  providers: [PostsService],
  imports: [
    UsersModule,
    TypeOrmModule.forFeature([Post, User]),
    TagsModule,
    PaginationModule, // ‚úÖ –ò–ú–ü–û–†–¢–ò–†–£–ï–ú –ú–û–î–£–õ–¨ –ü–ê–ì–ò–ù–ê–¶–ò–ò
  ],
})
export class PostsModule {}
```

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –∏–º–ø–æ—Ä—Ç –º–æ–¥—É–ª–µ–π –≤ NestJS:**

```
PostsModule ‚Üí imports ‚Üí PaginationModule ‚Üí exports ‚Üí PaginationProvider
     ‚Üì
PostsService –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å PaginationProvider —á–µ—Ä–µ–∑ DI
```

## üîß **–®–∞–≥ 3: –í–Ω–µ–¥—Ä–µ–Ω–∏–µ PaginationProvider –≤ PostsService**

### üíâ **Dependency Injection –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–µ:**

```typescript
// src/posts/providers/posts.service.ts
export class PostsService {
  constructor(
    @InjectRepository(Post)
    private readonly postsRepository: Repository<Post>,

    // ‚úÖ –í–ù–ï–î–†–ï–ù–ò–ï PAGINATION PROVIDER
    private readonly paginationProvider: PaginationProvider
  ) {}

  // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã
}
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –≤–Ω–µ–¥—Ä–µ–Ω–∏–∏:**

1. NestJS –≤–∏–¥–∏—Ç, —á—Ç–æ `PostsModule` –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç `PaginationModule`
2. `PaginationModule` —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç `PaginationProvider`
3. NestJS –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç —ç–∫–∑–µ–º–ø–ª—è—Ä `PaginationProvider`
4. –í–Ω–µ–¥—Ä—è–µ—Ç –µ–≥–æ –≤ `PostsService` —á–µ—Ä–µ–∑ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä

## üîß **–®–∞–≥ 4: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ PaginationProvider –≤ findAll**

### üîÑ **–ó–∞–º–µ–Ω–∞ —Ä—É—á–Ω–æ–π –ø–∞–≥–∏–Ω–∞—Ü–∏–∏:**

```typescript
// –ë–´–õ–û - —Ä—É—á–Ω–∞—è –ø–∞–≥–∏–Ω–∞—Ü–∏—è:
public async findAll(userId: string, postsQuery: GetPostsDto) {
    let posts = await this.postsRepository.find({
        skip: (postsQuery.page - 1) * postsQuery.limit,
        take: postsQuery.limit,
    });
    return posts;
}

// –°–¢–ê–õ–û - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ PaginationProvider:
public async findAll(userId: string, postsQuery: GetPostsDto) {
    const results = await this.paginationProvider.paginateQuery(
        {
            limit: postsQuery.limit,    // ‚úÖ –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
            page: postsQuery.page       // ‚úÖ –∏–∑ DTO
        },
        this.postsRepository            // ‚úÖ –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –¥–ª—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
    );

    return results;
}
```

## üîç **–î–µ—Ç–∞–ª—å–Ω—ã–π —Ä–∞–∑–±–æ—Ä –≤—ã–∑–æ–≤–∞ paginateQuery**

### üìû **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –º–µ—Ç–æ–¥–∞:**

```typescript
this.paginationProvider.paginateQuery(
  // 1. –ü–ê–†–ê–ú–ï–¢–†: PaginationQueryDto
  {
    limit: postsQuery.limit, // –ß–∏—Å–ª–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
    page: postsQuery.page, // –ù–æ–º–µ—Ä —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
  },

  // 2. –ü–ê–†–ê–ú–ï–¢–†: Repository<Post>
  this.postsRepository // –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Post
);
```

### üîÑ **–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤–Ω—É—Ç—Ä–∏ paginateQuery:**

```typescript
// –í–Ω—É—Ç—Ä–∏ PaginationProvider.paginateQuery:
public async paginateQuery<T extends ObjectLiteral>(
    paginationQuery: PaginationQueryDto, // { limit, page }
    repository: Repository<T>             // PostRepository
): Promise<T[]> {
    const { limit, page } = paginationQuery;

    return await repository.find({
        skip: (page - 1) * limit,  // –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Å–º–µ—â–µ–Ω–∏—è
        take: limit                // –õ–∏–º–∏—Ç —ç–ª–µ–º–µ–Ω—Ç–æ–≤
    });
}
```

## üß™ **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏**

### üî¨ **–¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å:**

```http
GET http://localhost:3000/posts?limit=1&page=3
```

### üî¨ **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**

```json
[
  {
    "id": 12,
    "title": "Post 12"
    // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ–ª—è –ø–æ—Å—Ç–∞
  }
]
```

**–ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ –ø–æ—Å—Ç —Å ID 12:**

- `limit=1` - 1 –ø–æ—Å—Ç –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
- `page=3` - —Ç—Ä–µ—Ç—å—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
- –ü—Ä–æ–ø—É—Å–∫–∞–µ–º `(3-1)*1 = 2` –ø–æ—Å—Ç–∞
- –ë–µ—Ä–µ–º 1 –ø–æ—Å—Ç –Ω–∞—á–∏–Ω–∞—è —Å 3-–π –ø–æ–∑–∏—Ü–∏–∏

## üéØ **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã**

### ‚úÖ **–£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–¥–∞:**

```typescript
// –†–ê–ù–¨–®–ï - –≤ –∫–∞–∂–¥–æ–º —Å–µ—Ä–≤–∏—Å–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–ª–∞—Å—å –ª–æ–≥–∏–∫–∞:
skip: (page - 1) * limit,
take: limit

// –¢–ï–ü–ï–†–¨ - –µ–¥–∏–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤ PaginationProvider
```

### ‚úÖ **–ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è:**

- –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ª–æ–≥–∏–∫–µ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ —Ç–æ–ª—å–∫–æ –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∫–æ –≤—Å–µ–º —Å–µ—Ä–≤–∏—Å–∞–º
- –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–ª–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### ‚úÖ **Type Safety:**

- Generics –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç —Ç–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- TypeORM –∑–Ω–∞–µ—Ç —Ç–∏–ø –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π
- –ê–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –≤ IDE —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

### ‚úÖ **–¢–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å:**

```typescript
// –õ–µ–≥–∫–æ –º–æ–∫–∏—Ä–æ–≤–∞—Ç—å PaginationProvider –≤ —Ç–µ—Å—Ç–∞—Ö
const mockPaginationProvider = {
  paginateQuery: jest.fn().mockResolvedValue([mockPost]),
};
```

## ‚ö†Ô∏è **–¢–µ–∫—É—â–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è (—á—Ç–æ –∞–≤—Ç–æ—Ä –ø–ª–∞–Ω–∏—Ä—É–µ—Ç –∏—Å–ø—Ä–∞–≤–∏—Ç—å)**

### ‚ùå **–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç–≤–µ—Ç–∞:**

```typescript
// –°–ï–ô–ß–ê–° –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è:
Post[]  // –ü—Ä–æ—Å—Ç–æ–π –º–∞—Å—Å–∏–≤

// –î–û–õ–ñ–ù–û –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å—Å—è:
Paginated<Post> {
    data: Post[],
    meta: { ... },
    links: { ... }
}
```

### ‚ùå **–ù–µ—Ç –ø–æ–¥—Å—á–µ—Ç–∞ –æ–±—â–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞:**

- –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ —Å–∫–æ–ª—å–∫–æ –≤—Å–µ–≥–æ –ø–æ—Å—Ç–æ–≤
- –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ —Ä–∞—Å—Å—á–∏—Ç–∞—Ç—å `totalPages`
- –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ `links`

### ‚ùå **–ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è userId:**

```typescript
// –ü–∞—Ä–∞–º–µ—Ç—Ä userId –ø—Ä–∏–Ω–∏–º–∞–µ—Ç—Å—è, –Ω–æ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è
public async findAll(userId: string, postsQuery: GetPostsDto)
```

## üîÆ **–ß—Ç–æ –±—É–¥–µ—Ç –≤ —Å–ª–µ–¥—É—é—â–∏—Ö –≤–∏–¥–µ–æ:**

### üéØ **–ü–ª–∞–Ω—ã –∞–≤—Ç–æ—Ä–∞:**

1. **–î–æ—Ä–∞–±–æ—Ç–∞—Ç—å `paginateQuery`** –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞ `Paginated<T>`
2. **–î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥—Å—á–µ—Ç `totalItems`** —Å –ø–æ–º–æ—â—å—é `repository.count()`
3. **–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –º–µ—Ç–∞-–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é** (currentPage, totalPages –∏ —Ç.–¥.)
4. **–°–æ–∑–¥–∞—Ç—å –Ω–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å—Å—ã–ª–∫–∏** –¥–ª—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
5. **–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –ø–æ userId**

## üéØ **–ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã, –∫–æ—Ç–æ—Ä—ã–µ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –∞–≤—Ç–æ—Ä:**

### 1. **Dependency Injection:**

- –ß–∏—Å—Ç–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- –õ–µ–≥–∫–∞—è –∑–∞–º–µ–Ω–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è —Ç–µ—Å—Ç–æ–≤)

### 2. **Module Encapsulation:**

- –ß–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –º–æ–¥—É–ª–µ–π
- –ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º—ã–π –¥–æ—Å—Ç—É–ø —á–µ—Ä–µ–∑ exports/imports

### 3. **Code Reusability:**

- –û–¥–Ω–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è - –º–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π
- –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–∞–≥–∏–Ω–∞—Ü–∏—é –∫ –Ω–æ–≤—ã–º —Å—É—â–Ω–æ—Å—Ç—è–º

### 4. **Incremental Refactoring:**

- –°–Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç–∞—é—â–∞—è –±–∞–∑–æ–≤–∞—è –≤–µ—Ä—Å–∏—è
- –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∞! –ë–∞–∑–æ–≤–∞—è –ø–∞–≥–∏–Ω–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç, –∏ –≤ —Å–ª–µ–¥—É—é—â–∏—Ö –≤–∏–¥–µ–æ –∞–≤—Ç–æ—Ä –¥–æ–±–∞–≤–∏—Ç –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –æ—Ç–≤–µ—Ç–∞. üöÄ
