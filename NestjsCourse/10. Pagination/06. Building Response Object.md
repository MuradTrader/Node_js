## üéØ **–¶–µ–ª—å: –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏**

### ‚ùå **–¢–µ–∫—É—â–∞—è –ø—Ä–æ–±–ª–µ–º–∞:**

```typescript
// –°–ï–ô–ß–ê–° –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –ø—Ä–æ—Å—Ç–æ–π –º–∞—Å—Å–∏–≤
Post[]

// –î–û–õ–ñ–ù–û –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å—Å—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ–±—ä–µ–∫—Ç
Paginated<Post> {
    data: Post[],
    meta: { ... },
    links: { ... }
}
```

## üîß **–®–∞–≥ 1: –í–Ω–µ–¥—Ä–µ–Ω–∏–µ Request –≤ PaginationProvider**

### üíâ **Dependency Injection –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –∑–∞–ø—Ä–æ—Å—É:**

```typescript
import { Inject, Injectable } from "@nestjs/common";
import { REQUEST } from "@nestjs/core";
import { Request } from "express";

@Injectable()
export class PaginationProvider {
  constructor(@Inject(REQUEST) private readonly request: Request) {}
}
```

### üîç **–î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è Request:**

#### **`@Inject(REQUEST)`**

```typescript
@Inject(REQUEST) private readonly request: Request
```

**–ß—Ç–æ —ç—Ç–æ –¥–∞–µ—Ç:**

- `REQUEST` - —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω –∏–∑ `@nestjs/core`
- –î–∞–µ—Ç –¥–æ—Å—Ç—É–ø –∫ –æ–±—ä–µ–∫—Ç—É HTTP –∑–∞–ø—Ä–æ—Å–∞ Express
- –°–æ–¥–µ—Ä–∂–∏—Ç –≤—Å—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤—Ö–æ–¥—è—â–µ–º –∑–∞–ø—Ä–æ—Å–µ

#### **–¢–∏–ø `Request` –∏–∑ Express:**

```typescript
import { Request } from "express";
```

- –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å Express.js –∑–∞–ø—Ä–æ—Å–∞
- –°–æ–¥–µ—Ä–∂–∏—Ç headers, URL, –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, body –∏ —Ç.–¥.

## üîß **–®–∞–≥ 2: –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –±–∞–∑–æ–≤–æ–≥–æ URL**

### üåê **–°–±–æ—Ä–∫–∞ baseUrl –∏–∑ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –∑–∞–ø—Ä–æ—Å–∞:**

```typescript
const baseUrl = `${this.request.protocol}://${this.request.headers.host}/`;
```

**–†–∞–∑–±–æ—Ä –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:**

#### **`this.request.protocol`**

```typescript
// –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–æ—Ç–æ–∫–æ–ª –∑–∞–ø—Ä–æ—Å–∞
'http' –∏–ª–∏ 'https'
```

#### **`this.request.headers.host`**

```typescript
// –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ö–æ—Å—Ç –∏ –ø–æ—Ä—Ç
'localhost:3000' –∏–ª–∏ 'api.example.com'
```

#### **–†–µ–∑—É–ª—å—Ç–∞—Ç baseUrl:**

```typescript
// –ü—Ä–∏–º–µ—Ä—ã:
"http://localhost:3000/";
"https://api.example.com/";
```

## üîß **–®–∞–≥ 3: –°–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ URL**

### üîó **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–ª–∞—Å—Å–∞ URL:**

```typescript
const url = new URL(this.request.url, baseUrl);
```

**–ß—Ç–æ —Ç–∞–∫–æ–µ –∫–ª–∞—Å—Å URL:**

- –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π JavaScript –∫–ª–∞—Å—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å URL
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–∞—Ä—Å–∏—Ç –∏ –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç URL
- –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —É–¥–æ–±–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º URL

### üìä **–°–≤–æ–π—Å—Ç–≤–∞ –æ–±—ä–µ–∫—Ç–∞ URL:**

```typescript
const url = new URL("/posts?limit=10&page=2", "http://localhost:3000/");

console.log(url.href); // 'http://localhost:3000/posts?limit=10&page=2'
console.log(url.origin); // 'http://localhost:3000'
console.log(url.pathname); // '/posts'
console.log(url.search); // '?limit=10&page=2'
```

## üîß **–®–∞–≥ 4: –†–∞—Å—á–µ—Ç –º–µ—Ç–∞-–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏**

### üìà **–ü–æ–ª—É—á–µ–Ω–∏–µ –æ–±—â–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤:**

```typescript
const totalItems = await repository.count();
```

**–ú–µ—Ç–æ–¥ `repository.count()`:**

- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π –≤ —Ç–∞–±–ª–∏—Ü–µ
- –í—ã–ø–æ–ª–Ω—è–µ—Ç SQL: `SELECT COUNT(*) FROM table`
- –ë—ã—Å—Ç—Ä–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è –¥–∞–∂–µ –¥–ª—è –±–æ–ª—å—à–∏—Ö —Ç–∞–±–ª–∏—Ü

### üßÆ **–†–∞—Å—á–µ—Ç –æ–±—â–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å—Ç—Ä–∞–Ω–∏—Ü:**

```typescript
const totalPages = Math.ceil(totalItems / paginationQuery.limit);
```

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ `Math.ceil()`:**

```typescript
// –ü—Ä–∏–º–µ—Ä—ã:
Math.ceil(15 / 10) = 2; // 15 items, 10 per page = 2 pages
Math.ceil(20 / 10) = 2; // 20 items, 10 per page = 2 pages
Math.ceil(21 / 10) = 3; // 21 items, 10 per page = 3 pages
```

**–ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ Math.ceil:**

- –û–∫—Ä—É–≥–ª—è–µ—Ç –≤–≤–µ—Ä—Ö –¥–æ –±–ª–∏–∂–∞–π—à–µ–≥–æ —Ü–µ–ª–æ–≥–æ
- –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –ø–æ–ø–∞–¥—É—Ç –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- –î–∞–∂–µ 1 —ç–ª–µ–º–µ–Ω—Ç –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ —Å–æ–∑–¥–∞–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É

## üîß **–®–∞–≥ 5: –†–∞—Å—á–µ—Ç —Å–ª–µ–¥—É—é—â–∏—Ö –∏ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —Å—Ç—Ä–∞–Ω–∏—Ü**

### ‚û°Ô∏è **–†–∞—Å—á–µ—Ç nextPage:**

```typescript
const nextPage =
  paginationQuery.page === totalPages
    ? paginationQuery.page // –ù–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ
    : paginationQuery.page + 1; // –ï—Å—Ç—å —Å–ª–µ–¥—É—é—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
```

**–õ–æ–≥–∏–∫–∞:**

- –ï—Å–ª–∏ —Ç–µ–∫—É—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ = –ø–æ—Å–ª–µ–¥–Ω–µ–π ‚Üí nextPage = —Ç–µ–∫—É—â–µ–π
- –ò–Ω–∞—á–µ ‚Üí nextPage = —Ç–µ–∫—É—â–∞—è + 1

### ‚¨ÖÔ∏è **–†–∞—Å—á–µ—Ç previousPage:**

```typescript
const previousPage =
  paginationQuery.page === 1
    ? paginationQuery.page // –ù–∞ –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ
    : paginationQuery.page - 1; // –ï—Å—Ç—å –ø—Ä–µ–¥—ã–¥—É—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
```

**–õ–æ–≥–∏–∫–∞:**

- –ï—Å–ª–∏ —Ç–µ–∫—É—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ = 1 ‚Üí previousPage = 1
- –ò–Ω–∞—á–µ ‚Üí previousPage = —Ç–µ–∫—É—â–∞—è - 1

## üéØ **–ü–æ–ª–Ω–∞—è –∫–∞—Ä—Ç–∏–Ω–∞ —Ä–∞—Å—á–µ—Ç–æ–≤**

### üìä **–ü—Ä–∏–º–µ—Ä –¥–ª—è 25 —ç–ª–µ–º–µ–Ω—Ç–æ–≤, limit=10:**

| –ü–∞—Ä–∞–º–µ—Ç—Ä       | –°—Ç—Ä–∞–Ω–∏—Ü–∞ 1 | –°—Ç—Ä–∞–Ω–∏—Ü–∞ 2 | –°—Ç—Ä–∞–Ω–∏—Ü–∞ 3 |
| -------------- | ---------- | ---------- | ---------- |
| `totalItems`   | 25         | 25         | 25         |
| `totalPages`   | 3          | 3          | 3          |
| `currentPage`  | 1          | 2          | 3          |
| `nextPage`     | 2          | 3          | 3          |
| `previousPage` | 1          | 1          | 2          |

## üîß **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏**

### ‚ö° **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏:**

```typescript
// –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
const [totalItems, results] = await Promise.all([
  repository.count(), // –ü–æ–¥—Å—á–µ—Ç –æ–±—â–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞
  repository.find({ skip, take }), // –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü—ã
]);
```

### üõ°Ô∏è **–û–±—Ä–∞–±–æ—Ç–∫–∞ edge cases:**

```typescript
// –ó–∞—â–∏—Ç–∞ –æ—Ç –¥–µ–ª–µ–Ω–∏—è –Ω–∞ –Ω–æ–ª—å
const totalPages =
  paginationQuery.limit > 0 ? Math.ceil(totalItems / paginationQuery.limit) : 1;
```

## üìä **–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç–≤–µ—Ç–∞**

### ‚úÖ **–£–∂–µ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–æ:**

- ‚úÖ `totalItems` - –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- ‚úÖ `totalPages` - –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–∞–Ω–∏—Ü
- ‚úÖ `nextPage` - –Ω–æ–º–µ—Ä —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- ‚úÖ `previousPage` - –Ω–æ–º–µ—Ä –ø—Ä–µ–¥—ã–¥—É—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- ‚úÖ `baseUrl` - –±–∞–∑–æ–≤—ã–π URL –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- ‚úÖ `url` - –æ–±—ä–µ–∫—Ç —Ä–∞–∑–æ–±—Ä–∞–Ω–Ω–æ–≥–æ URL –∑–∞–ø—Ä–æ—Å–∞

### ‚ùå **–ß—Ç–æ –æ—Å—Ç–∞–ª–æ—Å—å —Å–¥–µ–ª–∞—Ç—å (–≤ —Å–ª–µ–¥—É—é—â–µ–º –≤–∏–¥–µ–æ):**

- ‚ùå **–°–æ–±—Ä–∞—Ç—å –æ–±—ä–µ–∫—Ç `meta`** —Å –º–µ—Ç–∞-–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
- ‚ùå **–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –æ–±—ä–µ–∫—Ç `links`** —Å –Ω–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω—ã–º–∏ —Å—Å—ã–ª–∫–∞–º–∏
- ‚ùå **–í–µ—Ä–Ω—É—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç** `Paginated<T>`

## üéØ **–ö–ª—é—á–µ–≤—ã–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è**

### 1. **–ò–Ω—ä–µ–∫—Ü–∏—è Request:**

- –î–∞–µ—Ç –¥–æ—Å—Ç—É–ø –∫ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ç–µ–∫—É—â–µ–º –∑–∞–ø—Ä–æ—Å–µ
- –ü–æ–∑–≤–æ–ª—è–µ—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ URL –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏–π

### 2. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ URL –∫–ª–∞—Å—Å–∞:**

- –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Å–ø–æ—Å–æ–± —Ä–∞–±–æ—Ç—ã —Å URL –≤ JavaScript
- –ò–∑–±–µ–≥–∞–µ–º —Ä—É—á–Ω–æ–≥–æ –ø–∞—Ä—Å–∏–Ω–≥–∞ —Å—Ç—Ä–æ–∫

### 3. **Math.ceil –¥–ª—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏:**

- –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –≤–∫–ª—é—á–µ–Ω–∏–µ –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –≤ –≤–µ–±-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ

### 4. **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –ø–æ–¥—Å—á–µ—Ç:**

- `repository.count()` –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –æ—Å–Ω–æ–≤–Ω–æ–π –∑–∞–ø—Ä–æ—Å
- –ú–æ–∂–Ω–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ

## üîÆ **–ß—Ç–æ –±—É–¥–µ—Ç –≤ —Å–ª–µ–¥—É—é—â–µ–º –≤–∏–¥–µ–æ:**

–ê–≤—Ç–æ—Ä –ø–ª–∞–Ω–∏—Ä—É–µ—Ç –∑–∞–≤–µ—Ä—à–∏—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é, —Å–æ–±—Ä–∞–≤ –≤—Å–µ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç —Å–æ–≥–ª–∞—Å–Ω–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É `Paginated<T>`:

```typescript
{
    data: results,          // –ü–∞–≥–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
    meta: {
        itemsPerPage: limit,
        totalItems: totalItems,
        currentPage: page,
        totalPages: totalPages
    },
    links: {
        first: "...",
        last: "...",
        current: "...",
        next: "...",
        previous: "..."
    }
}
```

–≠—Ç–æ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π —à–∞–≥ –∫ —Å–æ–∑–¥–∞–Ω–∏—é production-ready –ø–∞–≥–∏–Ω–∞—Ü–∏–∏! üöÄ
