## üéØ **–ü—Ä–æ–±–ª–µ–º–∞: "–†–∞–∑–¥—É–≤–∞–Ω–∏–µ" —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤**

### üìä **–ò—Å—Ö–æ–¥–Ω–∞—è —Å–∏—Ç—É–∞—Ü–∏—è:**

```typescript
// users.service.ts - —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∏–º
export class UsersService {
  // –ú–Ω–æ–≥–æ –º–µ—Ç–æ–¥–æ–≤...
  public async createUser() {
    /* ... */
  }
  public async findAll() {
    /* ... */
  }
  public async findOneById() {
    /* ... */
  }
  public async createMany() {
    /* 20+ —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞ —Å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–µ–π */
  }
}
```

**–ü—Ä–æ–±–ª–µ–º—ã:**

- ‚ùå –î–ª–∏–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã —É–≤–µ–ª–∏—á–∏–≤–∞—é—Ç —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞
- ‚ùå –ù–∞—Ä—É—à–µ–Ω–∏–µ Single Responsibility Principle
- ‚ùå –°–ª–æ–∂–Ω–æ—Å—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

## üîß **–†–µ—à–µ–Ω–∏–µ: –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã**

### üèóÔ∏è **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π –ø–æ–¥—Ö–æ–¥:**

–ê–≤—Ç–æ—Ä –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –≤—ã–Ω–µ—Å—Ç–∏ —Å–ª–æ–∂–Ω—ã–π –º–µ—Ç–æ–¥ `createMany` –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–ª–∞—Å—Å-–ø—Ä–æ–≤–∞–π–¥–µ—Ä.

**–ù–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**

```
src/users/providers/
‚îú‚îÄ‚îÄ users.service.ts          # –û—Å–Ω–æ–≤–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
‚îî‚îÄ‚îÄ users-create-many.provider.ts # –°–ø–µ—Ü–∏—Ñ–∏—á–Ω–∞—è –ª–æ–≥–∏–∫–∞
```

## üìù **–®–∞–≥ 1: –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞**

### üî® **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Nest CLI:**

```bash
npx nest generate provider users/providers/users-create-many --no-spec
```

**–ß—Ç–æ —ç—Ç–æ —Å–æ–∑–¥–∞–µ—Ç:**

- `users-create-many.provider.ts` - –Ω–æ–≤—ã–π –∫–ª–∞—Å—Å –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç –ø—Ä–æ–≤–∞–π–¥–µ—Ä –≤ `UsersModule`

### üìÅ **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –Ω–æ–≤–æ–≥–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞:**

```typescript
import { DataSource } from "typeorm";
import { CreateUserDto } from "../dtos/create-user.dto";
import { User } from "../user.entity";

export class UsersCreateManyProvider {
  constructor(private readonly dataSource: DataSource) {}

  public async createMany(createUsersDto: CreateUserDto[]) {
    // –ü–µ—Ä–µ–Ω–µ—Å–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
  }
}
```

## üîÑ **–®–∞–≥ 2: –ü–µ—Ä–µ–Ω–æ—Å –ª–æ–≥–∏–∫–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏**

### üì§ **–ò–∑ UsersService:**

```typescript
// –ë–´–õ–û - 20+ —Å—Ç—Ä–æ–∫ –≤ UsersService
public async createMany(createUsersDto: CreateUserDto[]) {
    const queryRunner = this.dataSource.createQueryRunner();
    await queryRunner.connect();
    await queryRunner.startTransaction();

    let newUsers: User[] = [];
    try {
        for (const user of createUsersDto) {
            const newUser = queryRunner.manager.create(User, user);
            const result = await queryRunner.manager.save(newUser);
            newUsers.push(result);
        }
        await queryRunner.commitTransaction();
        return newUsers;
    } catch (error) {
        await queryRunner.rollbackTransaction();
        throw error;
    } finally {
        await queryRunner.release();
    }
}
```

### üì• **–í UsersCreateManyProvider:**

```typescript
// –°–¢–ê–õ–û - —Ç–∞ –∂–µ –ª–æ–≥–∏–∫–∞, –Ω–æ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –∫–ª–∞—Å—Å–µ
export class UsersCreateManyProvider {
  constructor(private readonly dataSource: DataSource) {}

  public async createMany(createUsersDto: CreateUserDto[]) {
    // –¢–û–ß–ù–ê–Ø –ö–û–ü–ò–Ø –õ–û–ì–ò–ö–ò –¢–†–ê–ù–ó–ê–ö–¶–ò–ò
    const queryRunner = this.dataSource.createQueryRunner();
    // ... –≤–µ—Å—å –∫–æ–¥ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
    return newUsers;
  }
}
```

## üíâ **–®–∞–≥ 3: –í–Ω–µ–¥—Ä–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤ UsersService**

### üîó **Dependency Injection:**

```typescript
// users.service.ts
export class UsersService {
  constructor(
    @InjectRepository(User)
    private usersRepository: Repository<User>,

    private readonly profileConfiguration: ConfigType<typeof profileConfig>,

    private readonly dataSource: DataSource,

    // ‚úÖ –ù–û–í–´–ô –ü–†–û–í–ê–ô–î–ï–†
    private readonly usersCreateManyProvider: UsersCreateManyProvider
  ) {}

  // –£–ü–†–û–©–ï–ù–ù–´–ô –ú–ï–¢–û–î createMany
  public async createMany(createUsersDto: CreateUserDto[]) {
    // –î–ï–õ–ï–ì–ò–†–£–ï–ú –í–´–ü–û–õ–ù–ï–ù–ò–ï –ü–†–û–í–ê–ô–î–ï–†–£
    return await this.usersCreateManyProvider.createMany(createUsersDto);
  }
}
```

## üéØ **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Ç–∞–∫–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞**

### ‚úÖ **Single Responsibility Principle:**

- `UsersService` - –æ–±—â–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- `UsersCreateManyProvider` - —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–∞—è –ª–æ–≥–∏–∫–∞ –º–∞—Å—Å–æ–≤–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è

### ‚úÖ **–£–ø—Ä–æ—â–µ–Ω–∏–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**

```typescript
// –ú–æ–∂–µ–º —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ
describe("UsersCreateManyProvider", () => {
  it("should create multiple users in transaction", () => {
    // —Ç–µ—Å—Ç–∏—Ä—É–µ–º —Ç–æ–ª—å–∫–æ –ª–æ–≥–∏–∫—É —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
  });
});
```

### ‚úÖ **–ü–æ–≤—Ç–æ—Ä–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**

- –ü—Ä–æ–≤–∞–π–¥–µ—Ä –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –¥—Ä—É–≥–∏—Ö —Å–µ—Ä–≤–∏—Å–∞—Ö
- –õ–æ–≥–∏–∫–∞ –∏–Ω–∫–∞–ø—Å—É–ª–∏—Ä–æ–≤–∞–Ω–∞ –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ

## üåê **–®–∞–≥ 4: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ API —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞**

### üöÄ **–ù–æ–≤—ã–π –º–∞—Ä—à—Ä—É—Ç –≤ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ:**

```typescript
@Controller("users")
export class UsersController {
  constructor(private readonly usersService: UsersService) {}

  // –°–£–©–ï–°–¢–í–£–Æ–©–ò–ô –≠–ù–î–ü–û–ò–ù–¢
  @Post()
  public createUser(@Body() createUserDto: CreateUserDto) {
    return this.usersService.createUser(createUserDto);
  }

  // ‚úÖ –ù–û–í–´–ô –≠–ù–î–ü–û–ò–ù–¢ –î–õ–Ø –ú–ê–°–°–û–í–û–ì–û –°–û–ó–î–ê–ù–ò–Ø
  @Post("create-many")
  public createManyUsers(@Body() createUsersDto: CreateUserDto[]) {
    return this.usersService.createMany(createUsersDto);
  }
}
```

### üîó **URL —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**

```
POST /users           ‚Üí —Å–æ–∑–¥–∞–Ω–∏–µ –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
POST /users/create-many ‚Üí —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
```

## üìä **–ò—Ç–æ–≥–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**

### üèóÔ∏è **–î–æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞:**

```
UsersService
‚îú‚îÄ‚îÄ createUser()
‚îú‚îÄ‚îÄ findAll()
‚îú‚îÄ‚îÄ findOneById()
‚îî‚îÄ‚îÄ createMany() ‚Üê —Å–ª–æ–∂–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
```

### üèóÔ∏è **–ü–æ—Å–ª–µ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞:**

```
UsersService                 UsersCreateManyProvider
‚îú‚îÄ‚îÄ createUser()             ‚îî‚îÄ‚îÄ createMany() ‚Üê –ª–æ–≥–∏–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
‚îú‚îÄ‚îÄ findAll()
‚îú‚îÄ‚îÄ findOneById()
‚îî‚îÄ‚îÄ createMany() ‚Üê –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
```

## üéØ **–ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã, –∫–æ—Ç–æ—Ä—ã–µ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –∞–≤—Ç–æ—Ä:**

1. **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏** - –∫–∞–∂–¥–∞—è —Å—É—â–Ω–æ—Å—Ç—å –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ —Å–≤–æ—é –∑–∞–¥–∞—á—É
2. **–ò–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏—è —Å–ª–æ–∂–Ω–æ—Å—Ç–∏** - —Å–ª–æ–∂–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Å–∫—Ä—ã—Ç–∞ –≤ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫–ª–∞—Å—Å–∞—Ö
3. **–ö–æ–º–ø–æ–∑–∏—Ü–∏—è –≤–º–µ—Å—Ç–æ –Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è** - —Å–±–æ—Ä–∫–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –∏–∑ –Ω–µ–±–æ–ª—å—à–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
4. **–£–ø—Ä–æ—â–µ–Ω–∏–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è** - –º–µ–Ω—å—à–∏–µ –º–æ–¥—É–ª–∏ –ª–µ–≥—á–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å
