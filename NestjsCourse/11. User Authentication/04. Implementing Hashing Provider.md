## üì¶ **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–∞ bcrypt**

–ê–≤—Ç–æ—Ä –Ω–∞—á–∏–Ω–∞–µ—Ç —Å —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–≥–æ –ø–∞–∫–µ—Ç–∞:

```bash
npm install bcrypt
```

–ö–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è –≤–µ—Ä—Å–∏—è: **5.1.1**
–ê–≤—Ç–æ—Ä —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç—É –∂–µ –≤–µ—Ä—Å–∏—é –¥–ª—è —Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –∫—É—Ä—Å—É.

## üîß **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –º–µ—Ç–æ–¥–æ–≤ BcryptProvider**

### **–ò–º–ø–æ—Ä—Ç bcrypt**

```typescript
import * as bcrypt from "bcrypt";
```

–ê–≤—Ç–æ—Ä –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –≤–µ—Å—å –º–æ–¥—É–ª—å bcrypt –ø–æ–¥ –∏–º–µ–Ω–µ–º `bcrypt`.

### **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –º–µ—Ç–æ–¥–∞ hashPassword**

**–®–∞–≥ 1: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ async –∏ public**

```typescript
// auth/providers/bcrypt.provider.ts

export class BcryptProvider implements HashingProvider {
  // –•–µ—à–∏—Ä—É–µ—Ç –ø–∞—Ä–æ–ª—å —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π —Å–æ–ª–∏
  public async hashPassword(data: string | Buffer): Promise<string> {
    // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–ª—É—á–∞–π–Ω—É—é —Å–æ–ª—å
    const salt = await bcrypt.genSalt();
    // –°–æ–∑–¥–∞–µ–º —Ö–µ—à –∏–∑ –ø–∞—Ä–æ–ª—è –∏ —Å–æ–ª–∏
    return await bcrypt.hash(data, salt);
  }
}
```

–ê–≤—Ç–æ—Ä –¥–µ–ª–∞–µ—Ç –º–µ—Ç–æ–¥ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º —Å `async` –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä –¥–æ—Å—Ç—É–ø–∞ `public`.

**–®–∞–≥ 2: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–æ–ª–∏**

```typescript
const salt = await bcrypt.genSalt();
```

- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –º–µ—Ç–æ–¥ `genSalt()` –∏–∑ bcrypt
- –ú–µ—Ç–æ–¥ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π, –ø–æ—ç—Ç–æ–º—É –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `await`
- –°–æ–ª—å –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

**–®–∞–≥ 3: –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª—è —Å —Å–æ–ª—å—é**

```typescript
return await bcrypt.hash(data, salt);
```

- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –º–µ—Ç–æ–¥ `hash()` –∏–∑ bcrypt
- –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –¥–≤–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞:
  - `data` - –ø–∞—Ä–æ–ª—å –¥–ª—è —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è
  - `salt` - —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–æ–ª—å
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≥–æ—Ç–æ–≤—ã–π —Ö–µ—à

### **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –º–µ—Ç–æ–¥–∞ comparePassword**

**–ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:**

```typescript
// auth/providers/bcrypt.provider.ts

export class BcryptProvider implements HashingProvider {
  // –•–µ—à–∏—Ä—É–µ—Ç –ø–∞—Ä–æ–ª—å —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π —Å–æ–ª–∏
  public async hashPassword(data: string | Buffer): Promise<string> {
    // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–ª—É—á–∞–π–Ω—É—é —Å–æ–ª—å
    const salt = await bcrypt.genSalt();
    // –°–æ–∑–¥–∞–µ–º —Ö–µ—à –∏–∑ –ø–∞—Ä–æ–ª—è –∏ —Å–æ–ª–∏
    return await bcrypt.hash(data, salt);
  }

  // **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –º–µ—Ç–æ–¥–∞ comparePassword**
  // –°—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç –≤–≤–µ–¥–µ–Ω–Ω—ã–π –ø–∞—Ä–æ–ª—å —Å —Ö–µ—à–µ–º –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
  public async comparePassword(
    data: string | Buffer,
    encrypted: string
  ): Promise<boolean> {
    // –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º –ø–∞—Ä–æ–ª—å —Å —Ö–µ—à–µ–º (bcrypt —Å–∞–º –∏–∑–≤–ª–µ–∫–∞–µ—Ç —Å–æ–ª—å –∏–∑ —Ö–µ—à–∞)
    return await bcrypt.compare(data, encrypted);
  }
}
```

- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –º–µ—Ç–æ–¥ `compare()` –∏–∑ bcrypt
- –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –¥–≤–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞:
  - `data` - –≤–≤–µ–¥–µ–Ω–Ω—ã–π –ø–∞—Ä–æ–ª—å –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
  - `encrypted` - —Ö–µ—à –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç `boolean` - —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å—Ä–∞–≤–Ω–µ–Ω–∏—è

## üéØ **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ bcrypt**

### **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ–ª—å—é**

–ê–≤—Ç–æ—Ä –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–µ—Ç, —á—Ç–æ bcrypt:

- –°–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–æ–ª—å
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ–ª–∏ –≤ environment-—Ñ–∞–π–ª–∞—Ö
- –í–∫–ª—é—á–∞–µ—Ç —Å–æ–ª—å –≤ –∏—Ç–æ–≥–æ–≤—ã–π —Ö–µ—à
- –ü—Ä–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑–≤–ª–µ–∫–∞–µ—Ç —Å–æ–ª—å –∏–∑ —Ö–µ—à–∞

### **–ü—Ä–æ—Å—Ç–æ—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è**

–ê–≤—Ç–æ—Ä –æ—Ç–º–µ—á–∞–µ—Ç –ª–µ–≥–∫–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã —Å bcrypt:

- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∫–æ–¥ –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
- –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- –ù–µ –Ω—É–∂–Ω–æ manually —É–ø—Ä–∞–≤–ª—è—Ç—å —Å–æ–ª—è–º–∏

## ‚úÖ **–ò—Ç–æ–≥–æ–≤—ã–π –∫–æ–¥ BcryptProvider**

–ü–æ—Å–ª–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –æ–±–∞ –º–µ—Ç–æ–¥–∞ –≥–æ—Ç–æ–≤—ã –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é:

- `hashPassword()` - –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –ø–∞—Ä–æ–ª—å, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ö–µ—à
- `comparePassword()` - –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –ø–∞—Ä–æ–ª—å –∏ —Ö–µ—à, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
