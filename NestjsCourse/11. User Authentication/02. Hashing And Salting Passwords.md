## üîê **–¢–µ–æ—Ä–∏—è —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —Å–æ–ª–µ–Ω–∏—è –ø–∞—Ä–æ–ª–µ–π**

### ‚ùå **–ü—Ä–æ–±–ª–µ–º–∞: –•—Ä–∞–Ω–µ–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π –≤ —á–∏—Å—Ç–æ–º –≤–∏–¥–µ**

**–ü–æ—á–µ–º—É —ç—Ç–æ –∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ–∞:**

- **–î–æ—Å—Ç—É–ø –∫ –ë–î = –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º –ø–∞—Ä–æ–ª—è–º** - –¥–∞–∂–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –º–æ–≥—É—Ç –≤–∏–¥–µ—Ç—å –ø–∞—Ä–æ–ª–∏
- **–£—Ç–µ—á–∫–∞ –¥–∞–Ω–Ω—ã—Ö** - —Ö–∞–∫–µ—Ä—ã –ø–æ–ª—É—á–∞—é—Ç –ø–∞—Ä–æ–ª–∏ "–∫–∞–∫ –µ—Å—Ç—å"
- **–¶–µ–ø–Ω–∞—è —Ä–µ–∞–∫—Ü–∏—è** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ–¥–Ω–∏ –ø–∞—Ä–æ–ª–∏ –Ω–∞ –º–Ω–æ–≥–∏—Ö —Å–∞–π—Ç–∞—Ö

### üîÑ **–†–µ—à–µ–Ω–∏–µ: –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ (Hashing)**

**–ß—Ç–æ —Ç–∞–∫–æ–µ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ:**

- –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª—è **–ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –¥–ª–∏–Ω—ã** –≤ —Å—Ç—Ä–æ–∫—É **—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –¥–ª–∏–Ω—ã**
- –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è **–º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã** (—Ö–µ—à-—Ñ—É–Ω–∫—Ü–∏–∏)
- –ü—Ä–æ—Ü–µ—Å—Å **–Ω–µ–æ–±—Ä–∞—Ç–∏–º—ã–π** - –Ω–µ–ª—å–∑—è –ø–æ–ª—É—á–∏—Ç—å –ø–∞—Ä–æ–ª—å –∏–∑ —Ö–µ—à–∞

```typescript
// –ü—Ä–∏–º–µ—Ä (—Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–π):
"myPassword123" ‚Üí "a1b2c3d4e5f6..." // —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –¥–ª–∏–Ω—ã
"short" ‚Üí "x9y8z7w6..."             // —Ç–æ–∂–µ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –¥–ª–∏–Ω—ã
```

**–ö–ª—é—á–µ–≤—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞:**

- ‚úÖ **–î–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç—å** - –æ–¥–∏–Ω –ø–∞—Ä–æ–ª—å = –æ–¥–∏–Ω —Ö–µ—à
- ‚úÖ **–ù–µ–æ–±—Ä–∞—Ç–∏–º–æ—Å—Ç—å** - –Ω–µ–ª—å–∑—è "—Ä–∞—Å—Ö–µ—à–∏—Ä–æ–≤–∞—Ç—å" –æ–±—Ä–∞—Ç–Ω–æ
- ‚úÖ **–§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–∞–∑–º–µ—Ä** - –ª—é–±–æ–π –ø–∞—Ä–æ–ª—å –¥–∞—Å—Ç —Ö–µ—à –æ–¥–∏–Ω–∞–∫–æ–≤–æ–π –¥–ª–∏–Ω—ã

### üéØ **–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–æ–ª—è:**

1. –ü—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏: `–ø–∞—Ä–æ–ª—å ‚Üí —Ö–µ—à ‚Üí —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Ö–µ—à`
2. –ü—Ä–∏ –≤—Ö–æ–¥–µ: `–≤–≤–µ–¥–µ–Ω–Ω—ã–π –ø–∞—Ä–æ–ª—å ‚Üí —Ö–µ—à ‚Üí —Å—Ä–∞–≤–Ω–∏–≤–∞–µ–º —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–º —Ö–µ—à–æ–º`

### üßÇ **–ü—Ä–æ–±–ª–µ–º–∞ —Ä–∞–¥—É–∂–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü –∏ —Ä–µ—à–µ–Ω–∏–µ - "–°–æ–ª—å" (Salt)**

**–†–∞–¥—É–∂–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã (Rainbow Tables):**

- –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –≤—ã—á–∏—Å–ª–µ–Ω–Ω—ã–µ —Ö–µ—à–∏ –¥–ª—è –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –ø–∞—Ä–æ–ª–µ–π
- –•–∞–∫–µ—Ä—ã –ø—Ä–æ—Å—Ç–æ –∏—â—É—Ç —Ö–µ—à –≤ —Ç–∞–±–ª–∏—Ü–µ –∏ –Ω–∞—Ö–æ–¥—è—Ç –ø–∞—Ä–æ–ª—å

**–†–µ—à–µ–Ω–∏–µ - "–°–æ–ª—å":**

- **–°–ª—É—á–∞–π–Ω–∞—è —Å—Ç—Ä–æ–∫–∞**, –∫–æ—Ç–æ—Ä–∞—è –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –∫ –ø–∞—Ä–æ–ª—é –ø–µ—Ä–µ–¥ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- –ö–∞–∂–¥–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é - —Å–≤–æ—è —É–Ω–∏–∫–∞–ª—å–Ω–∞—è —Å–æ–ª—å
- –î–∞–∂–µ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –ø–∞—Ä–æ–ª–∏ –¥–∞—é—Ç —Ä–∞–∑–Ω—ã–µ —Ö–µ—à–∏

```typescript
// –ë–µ–∑ —Å–æ–ª–∏:
"password123" ‚Üí "abc123" (—É –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å —ç—Ç–∏–º –ø–∞—Ä–æ–ª–µ–º –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π —Ö–µ—à)

// –° —Å–æ–ª—å—é:
"password123" + "saltUser1" ‚Üí "xyz789"
"password123" + "saltUser2" ‚Üí "def456"
```

### üîß **Bcrypt - –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ**

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ bcrypt —Ö–µ—à–∞:**

```
$2y$10$nOUIs5kJ7naTuTFkBy1veuK0kSxUFXfuaOKdOKf9xYT0KKIGSJwFa
‚îÇ   ‚îÇ  ‚îÇ                     ‚îÇ
‚îÇ   ‚îÇ  ‚îÇ                     ‚îî‚îÄ‚îÄ –•–µ—à (31 —Å–∏–º–≤–æ–ª)
‚îÇ   ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ –°–æ–ª—å (22 —Å–∏–º–≤–æ–ª–∞)
‚îÇ   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ Cost factor (10 = 2^10 –∏—Ç–µ—Ä–∞—Ü–∏–π)
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ –ê–ª–≥–æ—Ä–∏—Ç–º (2y = bcrypt)
```

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**

- **`$2y$`** - –≤–µ—Ä—Å–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞ bcrypt
- **`10`** - cost factor (—Ñ–∞–∫—Ç–æ—Ä —Å–ª–æ–∂–Ω–æ—Å—Ç–∏)
  - –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Ç–µ—Ä–∞—Ü–∏–π (2^10 = 1024 —Ä–∞–∑–∞)
  - –ß–µ–º –≤—ã—à–µ - —Ç–µ–º –º–µ–¥–ª–µ–Ω–Ω–µ–µ –≤–∑–ª–æ–º, –Ω–æ –¥–æ–ª—å—à–µ –ø—Ä–æ–≤–µ—Ä–∫–∞
- **–°–æ–ª—å** - —Å–ª—É—á–∞–π–Ω—ã–µ 22 —Å–∏–º–≤–æ–ª–∞
- **–•–µ—à** - —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–∞—Ä–æ–ª—å

### üîç **–ö–∞–∫ bcrypt –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–∞—Ä–æ–ª–∏:**

**–í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞:**

1. Bcrypt **–∏–∑–≤–ª–µ–∫–∞–µ—Ç —Å–æ–ª—å** –∏–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–≥–æ —Ö–µ—à–∞
2. **–î–æ–±–∞–≤–ª—è–µ—Ç —Å–æ–ª—å** –∫ –≤–≤–µ–¥–µ–Ω–Ω–æ–º—É –ø–∞—Ä–æ–ª—é
3. **–í—ã—á–∏—Å–ª—è–µ—Ç —Ö–µ—à** —Å —Ç–µ–º–∏ –∂–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ (cost factor)
4. **–°—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç** —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–º —Ö–µ—à–µ–º

```typescript
// –ü—Å–µ–≤–¥–æ–∫–æ–¥ —Ä–∞–±–æ—Ç—ã bcrypt.compare()
function compare(password, savedHash) {
  const salt = extractSalt(savedHash); // –ò–∑–≤–ª–µ–∫–∞–µ–º —Å–æ–ª—å –∏–∑ —Ö–µ—à–∞
  const cost = extractCost(savedHash); // –ò–∑–≤–ª–µ–∫–∞–µ–º cost factor

  const newHash = bcrypt(password, salt, cost); // –í—ã—á–∏—Å–ª—è–µ–º –Ω–æ–≤—ã–π —Ö–µ—à
  return newHash === savedHash; // –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º
}
```

### üõ°Ô∏è **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø–æ–¥—Ö–æ–¥–∞ –∞–≤—Ç–æ—Ä–∞:**

1. **–ù–µ –Ω—É–∂–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å —Å–æ–ª—å –æ—Ç–¥–µ–ª—å–Ω–æ** - –æ–Ω–∞ –≤—Å—Ç—Ä–æ–µ–Ω–∞ –≤ —Ö–µ—à
2. **–ù–µ—Ç —Å–µ–∫—Ä–µ—Ç–æ–≤ –≤ .env —Ñ–∞–π–ª–∞—Ö** - –≤—Å–µ —Å–∞–º–æ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ
3. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞—â–∏—Ç–∞** –æ—Ç —Ä–∞–¥—É–∂–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü
4. **–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å** —á–µ—Ä–µ–∑ cost factor

## üéØ **–ò—Ç–æ–≥ –ø—Ä–æ—Ü–µ—Å—Å–∞:**

```
–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è:
–ü–∞—Ä–æ–ª—å ‚Üí [Bcrypt + –°–æ–ª—å + Cost Factor] ‚Üí –•–µ—à ‚Üí –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –ë–î

–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:
–í–≤–µ–¥–µ–Ω–Ω—ã–π –ø–∞—Ä–æ–ª—å + [–°–æ–ª—å –∏–∑ –ë–î] ‚Üí [Bcrypt] ‚Üí –°—Ä–∞–≤–Ω–∏—Ç—å —Ö–µ—à–∏
```

–ê–≤—Ç–æ—Ä –æ—Ç–ª–∏—á–Ω–æ –æ–±—ä—è—Å–Ω–∏–ª —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏! –¢–µ–ø–µ—Ä—å –≤—ã –ø–æ–Ω–∏–º–∞–µ—Ç–µ **–ø–æ—á–µ–º—É** –º—ã –¥–µ–ª–∞–µ–º —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ **–∫–∞–∫** —ç—Ç–æ –∑–∞—â–∏—â–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. –í —Å–ª–µ–¥—É—é—â–µ–º –≤–∏–¥–µ–æ –Ω–∞—á–Ω–µ—Ç—Å—è –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ `bcrypt` –≤ NestJS.
